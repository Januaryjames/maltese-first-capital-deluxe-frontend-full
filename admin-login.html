<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Portal — Maltese First Capital</title>

  <!-- Keep your global CSS; scoped overrides below win where needed -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Favicons (paths already in your repo) -->
  <link rel="icon" type="image/png" href="assets/logo-crest.png" />
  <link rel="apple-touch-icon" href="assets/logo-crest.png" />
  <meta name="theme-color" content="#0b0f16" />

  <style>
    :root{
      --bg:#0b0f16; --panel:#0f151e; --ink:#e9eef7; --muted:#b8c2d3;
      --gold1:#d4af37; --gold2:#b28f2c;
      --navH:64px; --radius:16px;
    }
    html,body{background:var(--bg);color:var(--ink)}
    .container{max-width:1180px;margin:0 auto;padding:0 16px}

    /* ===== NAV (match index; force over any legacy rules) ===== */
    #siteHeader{position:sticky;top:0;z-index:2000;
      background:rgba(11,15,22,.86) !important;
      -webkit-backdrop-filter:saturate(160%) blur(12px);
      backdrop-filter:saturate(160%) blur(12px);
      border-bottom:1px solid rgba(255,255,255,.06)}
    .nav{height:var(--navH);display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px;color:#fff;text-decoration:none}
    .brand .crest{width:34px;height:34px;border-radius:10px;background:#fff;overflow:hidden;
      box-shadow:0 6px 16px rgba(0,0,0,.28);display:grid;place-items:center}
    .brand .crest img{width:100%;height:100%;object-fit:cover}
    .brand b{font-weight:700}
    .nav-links{display:flex;gap:22px;align-items:center}
    .nav-links a{color:#dfe6f2;text-decoration:none;padding:8px 12px;border-radius:10px}
    .nav-links a:hover,.nav-links a.active{background:rgba(255,255,255,.08);color:#fff}
    .nav-actions{display:flex;gap:10px}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 14px;
      border-radius:12px;border:1px solid rgba(255,255,255,.12);text-decoration:none;color:#fff;background:rgba(255,255,255,.06)}
    .btn-gold{border:1px solid rgba(212,175,55,.42);background:linear-gradient(180deg,var(--gold1),var(--gold2));
      color:#141414;font-weight:700;box-shadow:0 10px 24px rgba(212,175,55,.25)}
    .btn-lg{padding:14px 22px;border-radius:14px;font-size:17px}
    .btn-disabled{opacity:.6;pointer-events:none}
    .burger{display:none;border:0;background:transparent}
    .burger span{display:block;width:24px;height:2px;background:#fff;margin:5px;border-radius:2px}
    @media(max-width:980px){
      .nav-links{position:fixed;left:0;right:0;top:var(--navH);background:rgba(11,15,22,.96);
        transform:translateY(-8px);opacity:0;pointer-events:none;transition:.18s ease;padding:14px;flex-direction:column}
      .nav-links.open{transform:none;opacity:1;pointer-events:auto}
      .nav-actions{display:none}
      .burger{display:block}
    }
    /* Kill the extra bare links some hosts inject under the header */
    body > a[href], body > nav:not(#mainNav){display:none !important}

    /* ===== HERO ===== */
    .hero{background:url('assets/hero-bg.jpg') center/cover no-repeat;
      min-height:420px;display:flex;align-items:center;justify-content:center;text-align:center;
      border-bottom-left-radius:18px;border-bottom-right-radius:18px}
    .hero .crest-badge{width:220px;height:220px;border-radius:28px;background:#fff;margin:0 auto 18px;
      box-shadow:0 8px 24px rgba(0,0,0,.28);overflow:hidden;display:grid;place-items:center}
    .hero .crest-badge img{width:100%;height:100%;object-fit:cover}
    .hero h1{font-size:48px;line-height:1.06;margin:0 0 10px}
    .hero p{max-width:860px;margin:0 auto 18px;color:#f1f5ff}

    /* ===== CONTENT ===== */
    .section{padding:40px 0}
    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    .card{background:rgba(255,255,255,.02);border-radius:var(--radius);
      border:1px solid rgba(212,175,55,.35);box-shadow:0 1px 0 rgba(212,175,55,.22) inset}
    .card:hover{box-shadow:0 0 0 1px rgba(212,175,55,.46),0 12px 28px rgba(212,175,55,.16)}
    .pad{padding:20px}
    h2,h3{margin:0 0 10px}

    label{display:block;margin:8px 0 6px;font-weight:600}
    input{width:100%;background:var(--panel);color:var(--ink);
      border:1px solid rgba(255,255,255,.14);border-radius:12px;padding:12px 12px;outline:none}
    input:focus{border-color:rgba(212,175,55,.55);box-shadow:0 0 0 3px rgba(212,175,55,.18)}
    .row{display:grid;grid-template-columns:1fr;gap:12px}
    .muted{color:var(--muted)}
    .error{color:#ffb4b4}

    /* White footer with gold top border */
    .footer{background:#fff;color:#121212;border-top:4px solid var(--gold1);
      border-radius:16px 16px 0 0}
    .footer .container{padding:22px 16px}
  </style>
</head>
<body>
  <!-- HEADER -->
  <header id="siteHeader">
    <div class="container nav">
      <a class="brand" href="index.html" aria-label="Home">
        <span class="crest"><img src="assets/logo-crest.png" alt="Maltese First crest"></span>
        <b>Maltese First Capital</b>
      </a>

      <nav id="mainNav" class="nav-links" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="private-banking.html">Private Banking</a>
        <a href="wealth-management.html">Wealth Management</a>
        <a href="contact.html">Contact</a>
      </nav>

      <div class="nav-actions">
        <!-- On this page, keep the Admin button but disabled to show current context -->
        <a class="btn btn-gold btn-lg btn-disabled" href="#" aria-current="page">Admin Portal</a>
      </div>

      <button class="burger" aria-label="Menu" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero" role="banner" aria-label="Valletta skyline">
    <div class="container">
      <div class="crest-badge"><img src="assets/logo-crest.png" alt="Maltese First crest"></div>
      <h1>Admin Portal</h1>
      <p>Secure management access for operations, ledger, and compliance.</p>
    </div>
  </section>

  <!-- MAIN -->
  <main class="section">
    <div class="container grid">
      <section class="card pad">
        <h2>Sign in</h2>

        <!-- If JS is blocked, this will still post server-side -->
        <form id="adminForm" class="row" method="post" action="/api/admin/login" novalidate>
          <div>
            <label for="adminEmail">Admin Email</label>
            <input id="adminEmail" name="email" type="email" inputmode="email" autocomplete="username" required />
          </div>
          <div>
            <label for="adminPass">Password</label>
            <input id="adminPass" name="password" type="password" autocomplete="current-password" required />
          </div>
          <div>
            <label for="adminOTP">Two-Factor Code (if prompted)</label>
            <input id="adminOTP" name="otp" type="text" inputmode="numeric" autocomplete="one-time-code" placeholder="123456" />
          </div>

          <!-- Optional Cloudflare Turnstile placeholder (enable when you add a sitekey)
          <div class="cf-turnstile" data-sitekey="YOUR_TURNSTILE_SITE_KEY"></div>
          <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
          -->

          <div style="display:flex;gap:10px;align-items:center;margin-top:6px;flex-wrap:wrap">
            <button type="submit" class="btn btn-gold btn-lg" id="adminBtn">Enter</button>
            <a class="btn btn-lg" href="index.html">Back to Site</a>
            <span id="msg" class="muted" role="status" aria-live="polite"></span>
          </div>
        </form>
      </section>

      <aside class="card pad">
        <h3>Admin Security</h3>
        <ul style="margin:0 0 10px 18px">
          <li>Device fingerprinting & anomaly detection.</li>
          <li>5 failed attempts → temporary lockout.</li>
          <li>All actions are audit-logged.</li>
        </ul>
        <p class="muted" style="margin:0">Ops Support: <a href="mailto:hello@maltesefirst.com">hello@maltesefirst.com</a></p>
      </aside>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      © 2025 Maltese First Capital. The Exchange Building, Republic Street, Valletta VLT 1117, Malta ·
      <a href="mailto:hello@maltesefirst.com">hello@maltesefirst.com</a>
    </div>
  </footer>

  <script>
    // Mobile nav
    const burger = document.querySelector('.burger');
    const links  = document.querySelector('.nav-links');
    burger?.addEventListener('click', () => {
      const open = burger.getAttribute('aria-expanded') === 'true';
      burger.setAttribute('aria-expanded', String(!open));
      links.classList.toggle('open');
    });

    // Admin login via JSON; adjust if your backend expects form-encoded
    const API_ADMIN = '/api/admin/login';
    const form = document.getElementById('adminForm');
    const msg  = document.getElementById('msg');
    const btn  = document.getElementById('adminBtn');

    form?.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.textContent='';

      const email = document.getElementById('adminEmail').value.trim();
      const password = document.getElementById('adminPass').value;
      const otp = document.getElementById('adminOTP').value.trim();

      if(!email || !password){
        msg.textContent='Enter your email and password.'; msg.className='error'; return;
      }

      btn.disabled=true; const old=btn.textContent; btn.textContent='Verifying…';
      try{
        const res = await fetch(API_ADMIN,{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          credentials:'include',
          body:JSON.stringify({email,password,otp: otp || undefined})
        });
        if(!res.ok){
          const j = await res.json().catch(()=>({error:'Invalid credentials.'}));
          throw new Error(j.error || 'Invalid credentials.');
        }
        location.assign('admin-dashboard.html');
      }catch(err){
        msg.textContent = err.message || 'Sign-in failed.'; msg.className='error';
      }finally{
        btn.disabled=false; btn.textContent=old;
      }
    });
  </script>
</body>
</html>
