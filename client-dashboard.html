<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Client Dashboard — Maltese First Capital</title>
  <link rel="icon" href="/assets/logo-crest.png">
  <style>
    :root{--bg:#0b0f16;--card:#101722;--text:#e9eef8;--muted:#9eb0c7;--gold:#d4af37;--ok:#1db954}
    html,body{background:var(--bg);color:var(--text);margin:0;font-family:system-ui,-apple-system,Segoe UI,Inter,Roboto,sans-serif}
    .wrap{max-width:1160px;margin:0 auto;padding:20px}
    .nav{display:flex;align-items:center;gap:12px;padding:14px 0;border-bottom:1px solid rgba(255,255,255,.08)}
    .brand{display:flex;align-items:center;gap:10px;color:var(--text);text-decoration:none}
    .brand img{width:36px;height:36px;border-radius:8px;object-fit:contain;background:#0d131b}
    .brand b{letter-spacing:.3px}
    .logout{margin-left:auto}
    .grid{display:grid;grid-template-columns:1fr;gap:16px;margin-top:16px}
    @media (min-width:980px){ .grid{grid-template-columns:1.1fr .9fr} }
    .card{background:var(--card);border:1px solid rgba(212,175,55,.18);border-radius:16px;padding:18px}
    h2{margin:0 0 10px 0}
    .k{color:var(--muted);font-size:13px}
    .v{font-weight:600}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .pill{display:inline-flex;align-items:center;gap:8px;border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;background:#0d131b}
    .pill.ok{border-color:#224b36}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,.06);text-align:left}
    th{color:var(--muted);font-weight:600}
    .amt{white-space:nowrap}
    .pos{color:#9bf3b3}.neg{color:#ff9d9d}
    .ghost{color:var(--muted);font-size:14px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="nav">
      <a class="brand" href="/index.html"><img src="/assets/logo-crest.png" alt=""><b>Maltese First Capital</b></a>
      <a class="logout" href="#" id="logoutLink">Logout</a>
    </div>

    <div class="grid">
      <section class="card">
        <h2>Account Overview</h2>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
          <div><div class="k">Account Holder</div><div class="v" id="holderName">—</div></div>
          <div><div class="k">Authorised Person</div><div class="v" id="authPerson">—</div></div>
          <div><div class="k">Account Number</div><div class="v mono" id="acctNo">—</div></div>
          <div><div class="k">Status</div><div class="pill ok" id="acctStatus">active</div></div>
          <div><div class="k">Currency</div><div class="v" id="acctCcy">USD</div></div>
          <div><div class="k">Current Balance</div><div class="v" id="acctBal">—</div></div>
        </div>
      </section>

      <section class="card">
        <h2>Recent Transactions</h2>
        <div id="txBox" class="ghost">Loading…</div>
      </section>
    </div>
  </div>

  <script src="/scripts/config.mock.js"></script>
  <script src="/scripts/mock-auth.js"></script>
  <script>
    (()=>{
      const $ = s => document.querySelector(s);
      const { requireSession, getUser, clearSession, fmtMoney, renderTx } = window.MFC_AUTH;

      function titleCase(s){ return String(s||'').replace(/[._-]+/g,' ').replace(/\b\w/g,c=>c.toUpperCase()); }

      function logout(e){ e?.preventDefault(); clearSession(); window.location.href='/client-login.html'; }

      document.getElementById('logoutLink').addEventListener('click', logout);

      const session = requireSession();
      const user    = getUser(session?.email);

      if (!user) { logout(); }

      const acct = user.account || {};
      $('#holderName').textContent = user.holder || '—';
      $('#authPerson').textContent = user.authorisedPerson || titleCase(user.name || session.email.split('@')[0]);
      $('#acctNo').textContent     = acct.accountNo || '—';
      $('#acctStatus').textContent = acct.status || 'active';
      $('#acctCcy').textContent    = acct.currency || 'USD';
      $('#acctBal').textContent    = fmtMoney(Number(acct.balance||0), acct.currency || 'USD');
      document.getElementById('txBox').innerHTML = renderTx(acct.lines || [], acct.currency);
    })();
  </script>
</body>
</html>
