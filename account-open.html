<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Open an Account — Maltese First Capital</title>

  <!-- Favicon (keep your existing paths) -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/logo-crest.png">
  <link rel="icon" type="image/png" sizes="192x192" href="assets/logo-crest.png">
  <link rel="apple-touch-icon" href="assets/logo-crest.png">
  <link rel="mask-icon" href="assets/logo-crest.svg" color="#d4af37">
  <meta name="theme-color" content="#0b0f16" />

  <link rel="stylesheet" href="styles.css" />

  <style>
    /* ===== NAV (same look as index) ===== */
    .mfc-nav-wrap{position:sticky;top:0;z-index:1000;backdrop-filter:saturate(140%) blur(10px);background:rgba(10,14,22,.72);border-bottom:1px solid rgba(255,255,255,.08)}
    .mfc-nav{max-width:1200px;margin:0 auto;padding:12px 16px;display:grid;grid-template-columns:auto 1fr auto;gap:16px;align-items:center}
    .brand{display:flex;align-items:center;gap:10px;color:#fff;text-decoration:none}
    .brand-badge{width:28px;height:28px;border-radius:8px;background:#fff;display:grid;place-items:center;box-shadow:0 3px 10px rgba(0,0,0,.25);overflow:hidden}
    .brand-badge img{width:22px;height:22px;object-fit:contain}
    .brand span{font-weight:700;letter-spacing:.2px}
    .nav-links{display:flex;gap:18px;align-items:center;justify-content:center}
    .nav-links a{color:#e9eef8;text-decoration:none;padding:8px 12px;border-radius:10px}
    .nav-links a.active,.nav-links a:hover{background:rgba(255,255,255,.08)}
    .nav-actions{display:flex;gap:10px}
    .btn-nav{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 14px;border-radius:12px;font-weight:700;text-decoration:none;border:1px solid rgba(255,255,255,.12);color:#e9eef8;background:rgba(255,255,255,.06)}
    .btn-nav[disabled]{opacity:.6;cursor:not-allowed}
    .btn-gold{border-color:rgba(212,175,55,.35)!important;background:linear-gradient(180deg,#d4af37 0%,#b4912b 100%)!important;color:#111!important;box-shadow:0 10px 24px rgba(212,175,55,.25)}
    .btn-dark{border-color:rgba(255,255,255,.12)!important;background:rgba(255,255,255,.06)!important;color:#e9eef8!important}
    @media (max-width:880px){.nav-links{display:none}}

    /* ===== Page layout ===== */
    .page-wrap{max-width:1080px;margin:24px auto;padding:0 16px 24px}
    .card{background:linear-gradient(180deg,#0e121a 0%,#0b0f16 100%);border:1px solid rgba(212,175,55,.18);border-radius:18px;box-shadow:0 8px 24px rgba(0,0,0,.35);padding:22px;margin:18px 0}
    .card h2{margin:0 0 10px;font-weight:700;letter-spacing:.2px}
    .muted{opacity:.85;font-size:.95rem}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    @media (max-width:820px){.row{grid-template-columns:1fr}}
    label{display:block;font-size:.95rem;margin:10px 0 6px}
    input[type="text"],input[type="email"],input[type="tel"],input[type="file"],select,textarea{width:100%;padding:12px;background:#0b1017;color:#fff;border:1px solid rgba(255,255,255,.08);border-radius:12px;outline:none}
    textarea{min-height:90px;resize:vertical}
    .progress{height:10px;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.08);border-radius:999px;overflow:hidden;margin-top:12px}
    .progress>span{display:block;height:100%;width:0;background:linear-gradient(90deg,#d4af37,#f6e27a);transition:width .15s}
    .camera{border:1px dashed rgba(212,175,55,.35);border-radius:14px;padding:14px;background:#0b1017}
    .camera video,.camera img{width:100%;border-radius:12px}
    .camera .controls{display:flex;gap:10px;margin-top:10px;flex-wrap:wrap}
    .hint{font-size:.9rem;opacity:.8}
    .req{color:#f4d266;margin-left:4px}
    .footer-note{font-size:.9rem;opacity:.85}
  </style>
</head>
<body>
  <!-- Sticky translucent NAV -->
  <div class="mfc-nav-wrap">
    <div class="mfc-nav">
      <a class="brand" href="index.html" aria-label="Maltese First Capital — Home">
        <span class="brand-badge"><img src="assets/logo-crest.png" alt=""></span>
        <span>Maltese First Capital</span>
      </a>
      <nav class="nav-links" aria-label="Primary">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="private-banking.html">Private Banking</a>
        <a href="wealth-management.html">Wealth Management</a>
        <a href="contact.html">Contact</a>
      </nav>
      <div class="nav-actions">
        <a class="btn-nav" href="client-login.html">Client Login</a>
        <a class="btn-nav btn-gold" href="admin.html">Admin Portal</a>
      </div>
    </div>
  </div>

  <main class="page-wrap">
    <header class="card">
      <h1 style="margin:0 0 8px;">Open an Account</h1>
      <p class="muted">Provide your details and upload the KYC/AML documents. Our team will review and revert.</p>
    </header>

    <div id="formStatus" class="card" style="display:none;"></div>

    <!-- Success panel (hidden by default) WITH CTA -->
    <div id="submitDone" class="card" style="display:none; border-color: rgba(87,204,153,.35);">
      <div style="display:flex;align-items:center;gap:12px;">
        <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
          <path fill="#57CC99" d="M9.0 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4z"></path>
        </svg>
        <div>
          <h3 style="margin:0;">Application submitted</h3>
          <p class="muted" style="margin:4px 0 0;">
            Thank you—our onboarding team will email you shortly.
            You can continue browsing; no further action needed.
          </p>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:12px;flex-wrap:wrap;">
        <a class="btn-nav btn-gold" href="client-login.html" target="_top" rel="noopener">
          Proceed to Client Login
        </a>
        <a class="btn-nav btn-dark" href="index.html" target="_top" rel="noopener">
          Back to Home
        </a>
      </div>
    </div>

    <!-- ===========================================================
         FORM posts directly to backend email route, stays on page
         =========================================================== -->
    <form id="accountOpenForm"
          class="card"
          action="https://maltese-first-capital-deluxe-backend.onrender.com/api/onboarding/submit"
          method="post"
          enctype="multipart/form-data"
          novalidate
          autocomplete="off"
          target="submitBridge">

      <!-- Dummy fields to nuke browser autofill (keeps visuals unchanged) -->
      <input type="text" style="display:none" autocomplete="username">
      <input type="password" style="display:none" autocomplete="new-password">

      <h2>Client Information</h2>

      <div class="row">
        <div>
          <label>Company / Account Name <span class="req">*</span></label>
          <input name="company_name" type="text" placeholder="e.g., Al Ali Ltd" required autocomplete="off" />
        </div>
        <div>
          <label>Authorised Person <span class="req">*</span></label>
          <input name="authorized_person" type="text" placeholder="e.g., Mr. Bob Smith" required autocomplete="off" />
        </div>

        <div>
          <label>Email <span class="req">*</span></label>
          <input name="email" type="email" placeholder="name@company.com" required autocomplete="off" />
        </div>
        <div>
          <label>Phone</label>
          <input name="phone" type="tel" placeholder="+44 ..." autocomplete="off" />
        </div>

        <div>
          <label>Company Address</label>
          <input name="address" type="text" placeholder="Long Drive London" autocomplete="off" />
        </div>
        <div>
          <label>Country</label>
          <select name="country" autocomplete="off">
            <option value="">Select country…</option>
            <option value="Afghanistan">Afghanistan</option>
            <option value="Albania">Albania</option>
            <option value="Algeria">Algeria</option>
            <option value="Andorra">Andorra</option>
            <option value="Angola">Angola</option>
            <option value="Argentina">Argentina</option>
            <option value="Armenia">Armenia</option>
            <option value="Australia">Australia</option>
            <option value="Austria">Austria</option>
            <option value="Azerbaijan">Azerbaijan</option>
            <option value="Bahrain">Bahrain</option>
            <option value="Bangladesh">Bangladesh</option>
            <option value="Belarus">Belarus</option>
            <option value="Belgium">Belgium</option>
            <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option>
            <option value="Brazil">Brazil</option>
            <option value="Bulgaria">Bulgaria</option>
            <option value="Cambodia">Cambodia</option>
            <option value="Cameroon">Cameroon</option>
            <option value="Canada">Canada</option>
            <option value="Chile">Chile</option>
            <option value="China">China</option>
            <option value="Colombia">Colombia</option>
            <option value="Croatia">Croatia</option>
            <option value="Cyprus">Cyprus</option>
            <option value="Czech Republic">Czech Republic</option>
            <option value="Denmark">Denmark</option>
            <option value="Dominican Republic">Dominican Republic</option>
            <option value="Ecuador">Ecuador</option>
            <option value="Egypt">Egypt</option>
            <option value="Estonia">Estonia</option>
            <option value="Finland">Finland</option>
            <option value="France">France</option>
            <option value="Germany">Germany</option>
            <option value="Greece">Greece</option>
            <option value="Hungary">Hungary</option>
            <option value="Iceland">Iceland</option>
            <option value="India">India</option>
            <option value="Indonesia">Indonesia</option>
            <option value="Iran">Iran</option>
            <option value="Iraq">Iraq</option>
            <option value="Ireland">Ireland</option>
            <option value="Israel">Israel</option>
            <option value="Italy">Italy</option>
            <option value="Japan">Japan</option>
            <option value="Jordan">Jordan</option>
            <option value="Kenya">Kenya</option>
            <option value="Kuwait">Kuwait</option>
            <option value="Latvia">Latvia</option>
            <option value="Lebanon">Lebanon</option>
            <option value="Libya">Libya</option>
            <option value="Lithuania">Lithuania</option>
            <option value="Luxembourg">Luxembourg</option>
            <option value="Malaysia">Malaysia</option>
            <option value="Malta">Malta</option>
            <option value="Mexico">Mexico</option>
            <option value="Monaco">Monaco</option>
            <option value="Morocco">Morocco</option>
            <option value="Netherlands">Netherlands</option>
            <option value="New Zealand">New Zealand</option>
            <option value="Nigeria">Nigeria</option>
            <option value="Norway">Norway</option>
            <option value="Oman">Oman</option>
            <option value="Pakistan">Pakistan</option>
            <option value="Palestine">Palestine</option>
            <option value="Philippines">Philippines</option>
            <option value="Poland">Poland</option>
            <option value="Portugal">Portugal</option>
            <option value="Qatar">Qatar</option>
            <option value="Romania">Romania</option>
            <option value="Russia">Russia</option>
            <option value="Saudi Arabia">Saudi Arabia</option>
            <option value="Serbia">Serbia</option>
            <option value="Singapore">Singapore</option>
            <option value="Slovakia">Slovakia</option>
            <option value="Slovenia">Slovenia</option>
            <option value="South Africa">South Africa</option>
            <option value="South Korea">South Korea</option>
            <option value="Spain">Spain</option>
            <option value="Sri Lanka">Sri Lanka</option>
            <option value="Sweden">Sweden</option>
            <option value="Switzerland">Switzerland</option>
            <option value="Syria">Syria</option>
            <option value="Taiwan">Taiwan</option>
            <option value="Thailand">Thailand</option>
            <option value="Tunisia">Tunisia</option>
            <option value="Turkey">Turkey</option>
            <option value="Ukraine">Ukraine</option>
            <option value="United Arab Emirates">United Arab Emirates</option>
            <option value="United Kingdom">United Kingdom</option>
            <option value="United States">United States</option>
            <option value="Venezuela">Venezuela</option>
            <option value="Vietnam">Vietnam</option>
            <option value="Yemen">Yemen</option>
          </select>
        </div>

        <div>
          <label>Commercial Registration</label>
          <input name="commercial_registration" type="text" placeholder="CR / Company No." autocomplete="off" />
        </div>
        <div>
          <label>Account Type</label>
          <select name="account_type" autocomplete="off">
            <option>Corporate – Private Client (Onboarding)</option>
            <option>Corporate – Operating</option>
            <option>Individual – Private Banking</option>
          </select>
        </div>

        <div>
          <label>Primary Currency</label>
          <select name="currency" autocomplete="off">
            <option>USD</option><option>EUR</option><option>GBP</option><option>AED</option><option>SAR</option>
          </select>
        </div>
        <div>
          <label>Source of funds / purpose</label>
          <input name="source_of_funds" type="text" placeholder="Brief context…" autocomplete="off" />
        </div>
      </div>

      <label>Notes</label>
      <textarea name="notes" placeholder="Extra context for Compliance / Relationship team…" autocomplete="off"></textarea>

      <hr style="border-color: rgba(255,255,255,.08); margin:16px 0;" />

      <h2>KYC / AML Documents</h2>
      <p class="muted">Upload clear scans/photos. You can attach multiple files per section.</p>

      <label>Corporate Documents (CR, M&A, Board Resolution) <span class="req">*</span></label>
      <input name="docs_corporate" type="file" accept="image/*,.pdf" multiple required />

      <label>Authorised Person ID / Passport <span class="req">*</span></label>
      <input name="docs_id" type="file" accept="image/*,.pdf" multiple required />

      <label>Proof of Address (company / authorised person) <span class="req">*</span></label>
      <input name="docs_poa" type="file" accept="image/*,.pdf" multiple required />

      <label>Source of Funds / Wealth Evidence</label>
      <input name="docs_sof" type="file" accept="image/*,.pdf" multiple />

      <div class="card" style="margin-top:16px;">
        <h3 style="margin:0 0 8px;">Selfie (Face Verification)</h3>
        <p class="hint">Either upload a selfie or use your camera to capture one now.</p>
        <div class="row">
          <div>
            <label>Upload selfie image</label>
            <input name="selfie_file" type="file" accept="image/*" />
          </div>
          <div>
            <div class="camera">
              <video id="selfieVideo" playsinline muted style="display:none;"></video>
              <img id="selfiePreview" alt="Selfie preview" style="display:none;" />
              <div class="controls">
                <button type="button" class="btn-nav btn-gold" id="startCamBtn">Start Camera</button>
                <button type="button" class="btn-nav btn-gold" id="captureBtn" disabled>Capture Selfie</button>
                <button type="button" class="btn-nav btn-dark" id="resetCamBtn" disabled>Reset</button>
              </div>
              <p class="hint" style="margin-top:8px;">Tip: good light, head straight, no face coverings.</p>
            </div>
          </div>
        </div>
      </div>

      <label style="display:flex;gap:8px;align-items:center;margin-top:14px;">
        <input id="consentBox" type="checkbox" required />
        <span>I confirm the information is accurate and I authorise KYC/AML checks.</span>
      </label>

      <div class="progress" aria-hidden="true"><span id="uploadBar"></span></div>

      <div style="display:flex;gap:12px;margin-top:16px;flex-wrap:wrap;">
        <button id="submitBtn"
  class="btn-nav btn-gold"
  type="submit"
  formaction="https://maltese-first-capital-deluxe-backend.onrender.com/api/onboarding/submit"
  formmethod="post"
  formenctype="multipart/form-data"
  formtarget="submitBridge">
  Submit Application
</button>
        <button id="saveDraftBtn" class="btn-nav btn-dark" type="button">Save Draft (local)</button>
      </div>
    </form>

    <section class="card footer-note">
      Having trouble? Email <a href="mailto:hello@maltesefirst.com">hello@maltesefirst.com</a><br />
      © 2025 Maltese First Capital. The Exchange Building, Republic Street, Valletta VLT 1117, Malta.
    </section>

    <!-- Hidden iframe keeps page static after submit -->
    <iframe name="submitBridge" style="display:none;width:0;height:0;border:0;"></iframe>
  </main>

  <!-- Keep your existing lightweight scripts (no submit hijack on this page) -->
  <script src="scripts/forms.js" defer></script>
  <script src="/scripts/config.js?v=2"></script>
  <!-- Turnstile script removed on purpose -->
  <script src="/scripts/legal-footer.js?v=1" defer></script>
  <script src="/scripts/account-open-placeholders.js" defer></script>

  <!-- Tiny enhancer: shows success card after iframe load (no layout change) -->
  <script>
  (function () {
    const form   = document.getElementById('accountOpenForm');
    const frame  = document.querySelector('iframe[name="submitBridge"]');
    const status = document.getElementById('formStatus');
    const done   = document.getElementById('submitDone');
    const bar    = document.getElementById('uploadBar');
    const btn    = document.getElementById('submitBtn');
    const draft  = document.getElementById('saveDraftBtn');

    if (!form || !frame) return;

    // Hard reset + kill autofill on load (no visual change)
    window.addEventListener('DOMContentLoaded', function () {
      try { localStorage.removeItem('mfc_account_open_draft'); } catch(e){}
      form.reset();
      form.querySelectorAll('input, textarea, select').forEach(function (el) {
        el.value = '';
        el.removeAttribute('value');
        el.setAttribute('autocomplete','off');
      });
    });

    // Optional: local draft save (text fields only)
    if (draft) {
      draft.addEventListener('click', function () {
        try {
          const data = new FormData(form);
          const obj = {};
          for (const [k,v] of data.entries()) {
            if (v instanceof File) continue;
            obj[k] = v;
          }
          localStorage.setItem('mfc_account_open_draft', JSON.stringify(obj));
          alert('Draft saved locally.');
        } catch (e) { console.warn('Draft save failed:', e); }
      });
    }

    form.addEventListener('submit', function () {
      if (status) { status.style.display = 'block'; status.textContent = 'Uploading…'; }
      if (btn) btn.disabled = true;
      if (bar) bar.style.width = '45%';
    });

    // Cross-origin safe: react to iframe load only
    frame.addEventListener('load', function () {
      if (bar) bar.style.width = '100%';
      if (btn) btn.disabled = false;
      if (status) status.style.display = 'none';
      if (done) { done.style.display = 'block'; try { done.scrollIntoView({ behavior: 'smooth', block: 'start' }); } catch {} }
    });
  })();
  </script>
</body>
</html>
